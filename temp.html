<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <script src="assets/handsontable/dist/handsontable.full.min.js"></script>
    <link href="assets/handsontable/dist/handsontable.full.min.css" rel="stylesheet" media="screen">


    <script src="jstat/jstat.js"></script>

</head>
<body>
    

    <div id="example">


    </div>

    <button onclick="mostrarData()">
        Copiar data y mostarr
    </button>

    <input type="text" id="variableName" placeholder="Este es una nueva variable">
    <button onclick="cambiarNombre()">Cambair nombre de variable</button>

</body>
</html>

<script>

    var headers = ['Variable 1', '2 pinocho', '3 mostacho', '4 perolero', 'Funciona :v'];
    
    var data = [
        ['', 'Ford', 'Tesla', 'Toyota', 'Honda'],
        ['2017', 10, 11, 12, 13],
        ['2018', 20, 11, 14, 13],
        ['2019', 30, 15, 12, 13]
    ];

    var container = document.getElementById('example');


    var hot = new Handsontable(container, {
        data: data,
        rowHeaders: true,
        colHeaders: headers,
        filters: true,
        dropdownMenu: true,
        licenseKey: 'non-commercial-and-evaluation',
        manualColumnResize: true,
        outsideClickDeselects: false,
        bindRowsWithHeaders: 'strict',
        autoColumnSize: true
    });

    function mostrarData()
    {
        alert(hot.getData());
    }

    function cambiarNombre()
    {

        var number = hot.getSelected();

        number[0][1,3]

        if(number[0][1] == number[0][3])
        {
            headers[number[0][1]]=document.getElementById('variableName').value;
            //temporalmente cree en base a otros procesos que halle en la doc
            //no he hallado una propia que de la documentacion pero funciona
            hot.updateSettings({
                colHeaders: headers
            });

            hot.getPlugin('AutoColumnSize').recalculateAllColumnsWidth();

            hot.render();
        }

        



    }
</script>